<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Amigo Invisible</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 40px;
    }
    h1 { margin-bottom: 20px; }
    #resultado {
      font-size: 24px;
      font-weight: bold;
      margin-top: 30px;
    }
  </style>
</head>
<body>

<h1>ğŸ Amigo Invisible ğŸ</h1>
<div id="contenido"></div>

<script>
const personas = [
  "pili (tÃ­a)",
  "antonio",
  "anne",
  "juan junior",
  "juan padre",
  "carlota",
  "carolina",
  "azucena",
  "roberto",
  "abuela pili"
];

const params = new URLSearchParams(window.location.search);
const usuario = params.get("user");

if (!usuario || !personas.includes(usuario.toLowerCase())) {
  document.getElementById("contenido").innerHTML =
    "<p>âŒ Enlace no vÃ¡lido</p>";
} else {
  let asignaciones = JSON.parse(localStorage.getItem("amigoInvisible"));

  if (!asignaciones) {
    asignaciones = generarAsignaciones();
    localStorage.setItem("amigoInvisible", JSON.stringify(asignaciones));
  }

  const resultadoUsuario = asignaciones[usuario.toLowerCase()];

  document.getElementById("contenido").innerHTML = `
    <p>Hola <strong>${usuario}</strong> ğŸ‘‹</p>
    <div id="resultado">
      ğŸ Te ha tocado: <br><br>
      ğŸ‘‰ <strong>${resultadoUsuario}</strong>
    </div>
    <p style="margin-top:20px">ğŸ¤« No se lo digas a nadie</p>
  `;
}

function generarAsignaciones() {
  let copia = [...personas];
  let resultado = {};

  do {
    copia.sort(() => Math.random() - 0.5);
  } while (copia.some((p, i) => p === personas[i]));

  personas.forEach((p, i) => {
    resultado[p] = copia[i];
  });

  return resultado;
}
</script>

</body>
</html>
